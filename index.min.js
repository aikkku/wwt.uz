"use strict";

(function () {
  var lang = document.documentElement.lang;
  var md = new MobileDetect(window.navigator.userAgent);
  var buttonToggler = document.querySelector(".navbar-toggler");
  var navbarMenu = document.querySelector(".navbar-nav");
  var brandName = document.querySelector("#brand-name");
  var form = document.querySelector("form.form");
  var formD = {
    name: {
      value: ""
    },
    msg: {
      value: ""
    }
  };

  for (var i = 0; i < form.length; i++) {
    if (["input", "textarea"].includes(form[i].nodeName.toLowerCase())) {
      form[i].addEventListener("keyup", function (e) {
        console.log(e.target.value);

        if (e.target.nodeName === "INPUT" && e.target.value.length > 4) {
          formD.name.value = e.target.value;
        } else if (e.target.nodeName === "TEXTAREA" && e.target.value.length > 20) {
          console.log(e.target.value);
          formD.msg.value = e.target.value;
        }
      });
    }
  }

  form.addEventListener("submit", function (e) {
    e.preventDefault();

    if (!formD.name.value) {
      switch (lang) {
        case "en":
          alert("The length of the name must be at least 5 characters");
          break;

        case "uz":
          alert("Ism kamida 5 ta belgidan iborat bo'lishi kerak");
          break;

        default:
          alert("Длина имени должна быть минимум 5 символов");
          break;
      }
    }

    if (!formD.msg.value) {
      alert("Длина сообщения должна быть минимум 20 символов");

      switch (lang) {
        case "en":
          alert("The length of the message must be at least 20 characters");
          break;

        case "uz":
          alert("Xabar uzunligi kamida 20 belgidan iborat bo'lishi kerak");
          break;

        default:
          alert("Длина имени должна быть минимум 20 символов");
          break;
      }
    }

    if (formD.msg.value && formD.name.value) {
      var text = "\u0421\u041E\u041E\u0411\u0429\u0415\u041D\u0418\u0415 \u0421 \u0421\u0410\u0419\u0422\u0410 wwt.uz%0A\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u043B: *" + formD.name.value + "*%0A\u0422\u0435\u043A\u0441\u0442: *" + formD.msg.value + "*%0A\u0414\u0430\u0442\u0430: *" + new Date() + "* ";
      axios.get("https://api.telegram.org/bot936346863:AAF8-psLlGwvPmsfAk2GGvOeH_dOvIb22nk/sendMessage?chat_id=104500016&text=" + text + "&parse_mode=markdown").then(function (res) {
        if (res.status === 200) {
          switch (lang) {
            case "en":
              alert("Message sent successfully");
              break;

            case "uz":
              alert("Xabar muvaffaqiyatli yuborildi");
              break;

            default:
              alert("Сообщение отправлено успешно");
              break;
          }
        }
      }).catch(function (error) {
        switch (lang) {
          case "en":
            alert("Message not sent");
            break;

          case "uz":
            alert("Xabar yuborilmadi");
            break;

          default:
            alert("Сообщение не отправлено");
            break;
        }
      });
    }
  });

  var hideMenu = function hideMenu() {
    buttonToggler.classList.remove("active");
    document.body.style.overflow = "";
    navbarMenu.classList.remove("active");
  };

  var showMenu = function showMenu() {
    buttonToggler.classList.add("active");
    document.body.style.overflow = "hidden";
    navbarMenu.classList.add("active");
  };

  buttonToggler.addEventListener("click", function (e) {
    if (!buttonToggler.classList.contains("active")) {
      showMenu();
    } else {
      hideMenu();
    }
  });

  if (md.mobile()) {
    document.body.classList.add("mobile");
  }

  if (window.innerWidth < 350) {
    brandName.innerHTML = "WW<span>T</span>";
  }

  var lastWindowWidth = window.innerWidth;
  var ticking = false;

  var onResize = function onResize(width) {
    if (width < 350) {
      brandName.innerHTML = "WW<span>T</span>";
    } else {
      brandName.innerHTML = "WorldWide <span>Travel</span>";
    }
  };

  window.addEventListener("resize", function (e) {
    lastWindowWidth = window.innerWidth;

    if (!ticking) {
      window.requestAnimationFrame(function () {
        onResize(lastWindowWidth);
        ticking = false;
      });
      ticking = true;
    }
  });
})();

(function () {
  var navbar = document.querySelector(".navbar");
  var lastScrollY = 0;
  var ticking = false;

  var onScroll = function onScroll(scrollY) {
    if (scrollY > 60) {
      navbar.classList.add("fill");
    } else {
      navbar.classList.remove("fill");
    }
  };

  window.addEventListener("scroll", function (e) {
    lastScrollY = window.scrollY;

    if (!ticking) {
      window.requestAnimationFrame(function () {
        onScroll(lastScrollY);
        ticking = false;
      });
      ticking = true;
    }
  });
})();


